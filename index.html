<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dokuz Ta≈ü | Resm√Æ (AI + Online)</title>
  <script defer src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <style>
    :root{--bg:#0b1020;--panel:#121a33;--line:#93a4ff55;--text:#e9edff;--muted:#b9c2ff;--b:#2a3570}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:1120px;margin:0 auto;padding:14px;display:flex;flex-direction:column;gap:12px}
    .top{display:flex;flex-wrap:wrap;gap:12px;align-items:stretch}
    .card{background:var(--panel);border:1px solid var(--b);border-radius:14px;padding:12px}
    .boardCard{flex:1 1 580px;display:flex;align-items:center;justify-content:center}
    .infoCard{flex:1 1 360px;min-width:320px}
    h1{font-size:18px;margin:0 0 8px 0;font-weight:1000}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    button{border:1px solid var(--b);background:#0f1630;color:var(--text);padding:10px 12px;border-radius:12px;cursor:pointer;font-weight:900}
    button:hover{border-color:#4052b6}
    button:disabled{opacity:.55;cursor:not-allowed}
    input{width:100%;box-sizing:border-box;border:1px solid var(--b);background:#0f1630;color:var(--text);padding:12px;border-radius:12px}
    .pill{display:inline-block;padding:6px 10px;border-radius:999px;background:#0f1630;border:1px solid var(--b);color:var(--muted);font-size:12px}
    .status{margin-top:10px;line-height:1.35;color:var(--muted);min-height:52px;white-space:pre-line}
    .kpi{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
    .kpi div{background:#0f1630;border:1px solid var(--b);border-radius:12px;padding:10px;font-size:13px;color:var(--muted)}
    .kpi b{color:var(--text)}
    .small{font-size:12px;color:var(--muted)}
    .divider{height:1px;background:#24306a;margin:10px 0}

    svg{width:min(90vw,640px);height:auto}
    .line{stroke:var(--line);stroke-width:8;stroke-linecap:round}
    .pos{fill:#0f1630;stroke:var(--b);stroke-width:3}
    .pos.empty{cursor:pointer}
    .pos:hover{stroke:#6e84ff}
    .stoneW{fill:#f59e0b;stroke:#ffd08a;stroke-width:3}
    .stoneB{fill:#0b3a8a;stroke:#7aa2ff;stroke-width:3}
    .stoneW,.stoneB{pointer-events:none}
    .sel{stroke:#ffd166;stroke-width:5}
    .glow{filter:url(#glow)}

    .overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.82);backdrop-filter:blur(8px);align-items:center;justify-content:center;z-index:99999}
    .overlayBox{width:min(94vw,720px);border-radius:26px;padding:26px;border:2px solid #4052b6;background:#121a33;text-align:center;box-shadow:0 20px 80px rgba(0,0,0,.6)}
    .bigTitle{font-size:clamp(40px,8vw,86px);font-weight:1000;letter-spacing:1px;margin:0 0 10px 0;text-transform:uppercase}
    .subLine{font-size:clamp(16px,2.8vw,22px);color:#c9d0ff;margin:0 0 18px 0;line-height:1.4}
    .endIcon{font-size:64px;margin-bottom:8px}
  </style>
</head>

<body>
<div class="wrap">

  <div class="card" id="loginCard">
    <h1>Dokuz Ta≈ü ‚Äì Giri≈ü</h1>
    <div class="small">AI veya Online Oda se√ßilebilir. Online‚Äôda Host=Turuncu, Guest=Lacivert.</div>
    <div style="height:10px"></div>

    <label class="small">Ad Soyad</label>
    <input id="name" placeholder="√ñrn: Ay≈üe Yƒ±lmaz" autocomplete="name"/>
    <div style="height:10px"></div>

    <label class="small">Sƒ±nƒ±f / ≈ûube</label>
    <input id="classroom" placeholder="√ñrn: 5/A"/>
    <div style="height:12px"></div>

    <div class="row">
      <button id="startAI" type="button">Bilgisayara Kar≈üƒ± (AI)</button>
      <button id="toggleOnline" type="button">Online Rakip</button>
    </div>

    <div id="onlinePanel" style="display:none; margin-top:12px;">
      <div class="divider"></div>
      <div class="row">
        <button id="createRoom" type="button">Oda Olu≈ütur</button>
        <button id="joinRoomBtn" type="button">Koda Katƒ±l</button>
      </div>
      <div style="height:10px"></div>
      <label class="small">Oda Kodu</label>
      <input id="roomCode" placeholder="√ñrn: AB12CD" style="text-transform:uppercase"/>
      <div class="status" id="loginMsg"></div>
    </div>

    <div class="status" id="loginMsgMain"></div>
  </div>

  <div class="top" id="gameUI" style="display:none">
    <div class="card boardCard">
      <svg viewBox="0 0 1000 1000" aria-label="Dokuz ta≈ü tahtasƒ±">
        <defs>
          <filter id="glow">
            <feGaussianBlur stdDeviation="3.5" result="coloredBlur"/>
            <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
        </defs>

        <rect x="100" y="100" width="800" height="800" fill="none" class="line"/>
        <rect x="250" y="250" width="500" height="500" fill="none" class="line"/>
        <rect x="400" y="400" width="200" height="200" fill="none" class="line"/>

        <line x1="500" y1="100" x2="500" y2="400" class="line"/>
        <line x1="500" y1="600" x2="500" y2="900" class="line"/>
        <line x1="100" y1="500" x2="400" y2="500" class="line"/>
        <line x1="600" y1="500" x2="900" y2="500" class="line"/>

        <g id="positions"></g>
      </svg>
    </div>

    <div class="card infoCard">
      <h1>Durum Paneli</h1>

      <div class="row" style="margin-bottom:6px;">
        <span class="pill" id="modePill">Mod: -</span>
        <span class="pill" id="youPill">Sen: -</span>
        <span class="pill" id="roomPill" style="display:none;">Oda: -</span>
      </div>

      <div class="row">
        <span class="pill">Turuncu (W)</span>
        <span class="pill">Lacivert (B)</span>
        <span class="pill" id="phasePill">A≈üama: Ta≈ü koyma</span>
      </div>

      <div class="kpi">
        <div>Turuncu: Tahtada <b id="wOnBoard">0</b> / Yerle≈üen <b id="wPlaced">0</b></div>
        <div>Lacivert: Tahtada <b id="bOnBoard">0</b> / Yerle≈üen <b id="bPlaced">0</b></div>
      </div>

      <div class="status" id="status"></div>

      <div class="row" style="margin-top:10px;">
        <button id="newBtn" type="button">Yeni Oyun</button>
        <button id="undoBtn" type="button">Geri Al</button>
        <button id="hintBtn" type="button">ƒ∞pucu</button>
        <button id="leaveBtn" type="button">√áƒ±k</button>
      </div>

      <div class="divider"></div>

      <div class="small">
        Online‚Äôda <b>geri al</b> ve <b>ipucu</b> kapalƒ±dƒ±r.<br/>
        Deƒüirmen olursa √∂nce hamle tahtaya d√º≈üer, sonra ‚ÄúTa≈ü al‚Äù a≈üamasƒ± ba≈ülar.
      </div>
    </div>
  </div>
</div>

<div class="overlay" id="endOverlay">
  <div class="overlayBox">
    <div class="endIcon" id="endIcon">üèÅ</div>
    <div class="bigTitle" id="endTitle">OYUN Bƒ∞TTƒ∞</div>
    <div class="subLine" id="endText"></div>
    <div class="row" style="justify-content:center;">
      <button id="endNewBtn" type="button">Yeni Oyun</button>
      <button id="endCloseBtn" type="button">Kapat</button>
    </div>
  </div>
</div>

<script type="module">
/* =========================================================
   ‚úÖ KRƒ∞Tƒ∞K D√úZELTME:
   Firebase/Firestore sayfa a√ßƒ±lƒ±rken import edilmiyor.
   Sadece Online se√ßilince dinamik import ediliyor.
   B√∂ylece AI butonu her ko≈üulda √ßalƒ±≈üƒ±r.
========================================================= */

const $ = s => document.querySelector(s);
const setLoginMsg = t => $("#loginMsg").textContent = t;
const setLoginMsgMain = t => $("#loginMsgMain").textContent = t;
const setStatus = t => $("#status").textContent = t;

function profileOK(){
  const name = $("#name").value.trim();
  const classroom = $("#classroom").value.trim();
  if(!name || !classroom){
    setLoginMsgMain("Ad Soyad ve Sƒ±nƒ±f/≈ûube zorunlu.");
    return false;
  }
  setLoginMsgMain("");
  return true;
}

function openGameUI(){
  $("#loginCard").style.display="none";
  $("#gameUI").style.display="flex";
  hideEndOverlay();
}
function openLoginUI(){
  $("#loginCard").style.display="block";
  $("#gameUI").style.display="none";
  hideEndOverlay();
}

/* ================= Overlay ================= */
function hideEndOverlay(){ $("#endOverlay").style.display="none"; }
function showEndOverlay(winner){
  const mySide = (MODE==="ONLINE" ? ROLE : "W");
  $("#endOverlay").style.display="flex";

  const won = (winner === mySide);
  if(winner==="DRAW"){
    $("#endIcon").textContent="ü§ù";
    $("#endTitle").textContent="BERABERE";
    $("#endText").textContent="Oyun bitti.";
    return;
  }

  if(won){
    $("#endIcon").textContent="üèÜ";
    $("#endTitle").textContent="KAZANDIN!";
    $("#endText").textContent="Tebrikler üéâ";
    if(window.confetti){
      confetti({ particleCount: 240, spread: 120, origin:{y:0.65} });
      setTimeout(()=>confetti({ particleCount: 180, spread: 140, origin:{y:0.55} }), 220);
      setTimeout(()=>confetti({ particleCount: 140, spread: 160, origin:{y:0.50} }), 440);
    }
  }else{
    $("#endIcon").textContent="üòî";
    $("#endTitle").textContent="KAYBETTƒ∞N";
    $("#endText").textContent="Tekrar dene ‚Äî bu sefer olacak.";
  }
}
$("#endCloseBtn").addEventListener("click", hideEndOverlay);

/* ================= Board Data ================= */
const POS=[
  [100,100],[500,100],[900,100],
  [250,250],[500,250],[750,250],
  [400,400],[500,400],[600,400],
  [100,500],[250,500],[400,500],[600,500],[750,500],[900,500],
  [400,600],[500,600],[600,600],
  [250,750],[500,750],[750,750],
  [100,900],[500,900],[900,900]
];
const ADJ=[
  [1,9],[0,2,4],[1,14],[4,10],[1,3,5,7],[4,13],[7,11],[4,6,8],[7,12],
  [0,10,21],[3,9,11,18],[6,10,15],[8,13,17],[5,12,14,20],[2,13,23],
  [11,16],[15,17,19],[12,16],[10,19],[16,18,20,22],[13,19],[9,22],[19,21,23],[14,22]
];
const MILLS=[
  [0,1,2],[3,4,5],[6,7,8],[9,10,11],[12,13,14],[15,16,17],[18,19,20],[21,22,23],
  [0,9,21],[3,10,18],[6,11,15],[1,4,7],[16,19,22],[8,12,17],[5,13,20],[2,14,23]
];
const positionsG = document.getElementById("positions");

/* ================= Game State ================= */
let MODE=null;     // "AI" | "ONLINE"
let ROLE="W";
let ROOM=null;

let game=freshState();
let history=[];
let lastHumanMove=null;

function freshState(){
  return {board:Array(24).fill(null),turn:"W",placed:{W:0,B:0},pendingMover:null,capture:null,winner:null};
}
function countOnBoard(board,p){return board.filter(x=>x===p).length;}
function phaseOf(state,p){return state.placed[p]<9?"placing":"moving";}
function canFly(state,p){return phaseOf(state,p)==="moving" && countOnBoard(state.board,p)===3;}
function millsFormedBy(board,p,pos){return MILLS.filter(m=>m.includes(pos)&&m.every(i=>board[i]===p));}
function isInAnyMill(board,p,idx){return MILLS.some(m=>m.includes(idx)&&m.every(i=>board[i]===p));}
function removableOpponentStones(board,opp){
  const idx=board.map((v,i)=>v===opp?i:-1).filter(i=>i>=0);
  const notMill=idx.filter(i=>!isInAnyMill(board,opp,i));
  return notMill.length?notMill:idx;
}
function hasAnyLegalMove(state,p){
  const b=state.board;
  if(phaseOf(state,p)==="placing") return b.some(x=>x===null);
  const fly=canFly(state,p);
  const my=b.map((v,i)=>v===p?i:-1).filter(i=>i>=0);
  if(fly) return b.some(x=>x===null) && my.length>0;
  for(const from of my){ if(ADJ[from].some(to=>b[to]===null)) return true; }
  return false;
}
function checkWinner(state){
  if(state.placed.W<9||state.placed.B<9) return null;
  const w=countOnBoard(state.board,"W");
  const b=countOnBoard(state.board,"B");
  if(w<3||!hasAnyLegalMove(state,"W")) return "B";
  if(b<3||!hasAnyLegalMove(state,"B")) return "W";
  return null;
}

function applyAction(state,p,action){
  const opp=(p==="W")?"B":"W";
  const s=JSON.parse(JSON.stringify(state));
  const b=s.board;
  if(s.winner) return s;

  if(s.capture){
    if(action.type!=="capture") throw new Error("Ta≈ü almalƒ±sƒ±n");
    if(s.capture.by!==p) throw new Error("Ta≈üƒ± sen alamazsƒ±n");
    if(b[action.at]!==opp) throw new Error("Rakip ta≈üƒ± deƒüil");
    if(!s.capture.removable.includes(action.at)) throw new Error("Bu ta≈üƒ± alamazsƒ±n");
    b[action.at]=null;
    s.capture=null;
    s.turn=opp;
    s.winner=checkWinner(s);
    return s;
  }

  const myPhase=phaseOf(s,p);

  if(action.type==="place"){
    if(myPhase!=="placing") throw new Error("Ta≈ü koyma bitti");
    if(b[action.to]!==null) throw new Error("Dolu");
    b[action.to]=p; s.placed[p]+=1;

    const mill=millsFormedBy(b,p,action.to).length>0;
    if(mill){
      s.capture={by:p,removable:removableOpponentStones(b,opp)};
      s.turn=p;
    }else s.turn=opp;

    s.winner=checkWinner(s);
    return s;
  }

  if(action.type==="move"){
    if(myPhase!=="moving") throw new Error("√ñnce ta≈ülar dizilmeli");
    if(b[action.from]!==p) throw new Error("Kendi ta≈üƒ± deƒüil");
    if(b[action.to]!==null) throw new Error("Hedef dolu");
    const fly=canFly(s,p);
    if(!fly && !ADJ[action.from].includes(action.to)) throw new Error("Kom≈üu deƒüil");

    b[action.from]=null; b[action.to]=p;
    const mill=millsFormedBy(b,p,action.to).length>0;
    if(mill){
      s.capture={by:p,removable:removableOpponentStones(b,opp)};
      s.turn=p;
    }else s.turn=opp;

    s.winner=checkWinner(s);
    return s;
  }

  throw new Error("Ge√ßersiz hamle");
}

/* ================= UI Render ================= */
function updateKPI(){
  $("#wOnBoard").textContent=countOnBoard(game.board,"W");
  $("#bOnBoard").textContent=countOnBoard(game.board,"B");
  $("#wPlaced").textContent=game.placed.W;
  $("#bPlaced").textContent=game.placed.B;
  $("#phasePill").textContent="A≈üama: "+((game.placed.W<9||game.placed.B<9)?"Ta≈ü koyma":"Hareket");

  $("#modePill").textContent="Mod: "+(MODE==="AI"?"Bilgisayar":"Online");
  if(MODE==="AI"){
    $("#youPill").textContent="Sen: Turuncu (W)";
    $("#roomPill").style.display="none";
  }else{
    $("#youPill").textContent=(ROLE==="W"?"Sen: Turuncu (Host)":"Sen: Lacivert (Guest)");
    $("#roomPill").style.display="inline-block";
    $("#roomPill").textContent="Oda: "+ROOM;
  }
}
function render(){
  positionsG.innerHTML="";
  for(let i=0;i<24;i++){
    const [x,y]=POS[i];
    const v=game.board[i];
    const g=document.createElementNS("http://www.w3.org/2000/svg","g");

    const c=document.createElementNS("http://www.w3.org/2000/svg","circle");
    c.setAttribute("cx",x); c.setAttribute("cy",y); c.setAttribute("r",26);
    c.classList.add("pos");
    if(v===null) c.classList.add("empty");
    if(game.pendingMover===i) c.classList.add("sel","glow");
    c.addEventListener("click",()=>onClickPos(i));
    g.appendChild(c);

    if(v!==null){
      const s=document.createElementNS("http://www.w3.org/2000/svg","circle");
      s.setAttribute("cx",x); s.setAttribute("cy",y); s.setAttribute("r",18);
      s.classList.add(v==="W"?"stoneW":"stoneB");
      s.classList.add("glow");
      g.appendChild(s);
    }
    positionsG.appendChild(g);
  }

  updateKPI();
  $("#hintBtn").disabled=(MODE!=="AI") || !!game.winner;
  $("#undoBtn").disabled=(MODE!=="AI") || (history.length<=1);
}
function setTurnText(){
  if(game.winner){ setStatus("Oyun bitti."); return; }
  if(game.capture){
    setStatus((game.capture.by==="W"?"Turuncu":"Lacivert")+" deƒüirmen yaptƒ±. 1 ta≈ü alƒ±nmalƒ±.");
    return;
  }
  if(MODE==="AI"){
    setStatus(game.turn==="W"?"Sƒ±ra sende.":"AI oynuyor...");
  }else{
    setStatus((game.turn==="W"?"Turuncu":"Lacivert")+" sƒ±rasƒ±.");
  }
}

/* ================= Click Logic (AI) ================= */
function doActionAI(action){
  try{
    const before=JSON.parse(JSON.stringify(game));
    game=applyAction(game,"W",action);

    if(action.type==="move") lastHumanMove={from:action.from,to:action.to};
    else lastHumanMove=null;

    history.push(before);
    render();

    if(game.winner){ showEndOverlay(game.winner); return; }
    if(game.capture && game.capture.by==="W"){ setStatus("Deƒüirmen! 1 ta≈ü al."); return; }

    // AI hamlesi (basit)
    aiStep();
  }catch(e){
    setStatus("Hamle olmadƒ±: "+(e?.message||e));
  }
}

function generateActions(state,p){
  const actions=[];
  if(state.capture){
    if(state.capture.by!==p) return actions;
    for(const at of state.capture.removable) actions.push({type:"capture",at});
    return actions;
  }
  const b=state.board;
  const phase=phaseOf(state,p);
  if(phase==="placing"){
    for(let to=0;to<24;to++) if(b[to]===null) actions.push({type:"place",to});
    return actions;
  }
  const fly=canFly(state,p);
  const my=b.map((v,i)=>v===p?i:-1).filter(i=>i>=0);
  for(const from of my){
    const targets=fly ? b.map((v,i)=>v===null?i:-1).filter(i=>i>=0) : ADJ[from].filter(to=>b[to]===null);
    for(const to of targets) actions.push({type:"move",from,to});
  }
  return actions;
}
function evalState(state){
  if(state.winner==="B") return 1e9;
  if(state.winner==="W") return -1e9;
  const w=countOnBoard(state.board,"W");
  const b=countOnBoard(state.board,"B");
  let s=(b-w)*100;
  const millsW=MILLS.filter(m=>m.every(i=>state.board[i]==="W")).length;
  const millsB=MILLS.filter(m=>m.every(i=>state.board[i]==="B")).length;
  s+=(millsB-millsW)*70;
  if(state.capture) s+=(state.capture.by==="B")?120:-120;
  return s;
}
function minimax(state,depth,alpha,beta,maxB){
  if(depth===0||state.winner) return {score:evalState(state),action:null};
  const p=maxB?"B":"W";
  const acts=generateActions(state,p);
  if(!acts.length) return {score:evalState(state),action:null};

  let bestAction=null;
  if(maxB){
    let best=-Infinity;
    for(const a of acts){
      const next=applyAction(state,p,a);
      const r=minimax(next,depth-1,alpha,beta,false);
      if(r.score>best){best=r.score;bestAction=a;}
      alpha=Math.max(alpha,best);
      if(beta<=alpha) break;
    }
    return {score:best,action:bestAction};
  }else{
    let best=Infinity;
    for(const a of acts){
      const next=applyAction(state,p,a);
      const r=minimax(next,depth-1,alpha,beta,true);
      if(r.score<best){best=r.score;bestAction=a;}
      beta=Math.min(beta,best);
      if(beta<=alpha) break;
    }
    return {score:best,action:bestAction};
  }
}
function aiStep(){
  if(game.winner) return;
  // AI = B
  if(game.capture){
    if(game.capture.by!=="B") return;
  }else{
    if(game.turn!=="B") return;
  }
  setStatus("AI d√º≈ü√ºn√ºyor...");
  setTimeout(()=>{
    const depth=(game.placed.W<9||game.placed.B<9)?3:4;
    const {action}=minimax(game,depth,-Infinity,Infinity,true);
    if(!action){ game.winner=checkWinner(game)||"W"; render(); showEndOverlay(game.winner); return; }
    game=applyAction(game,"B",action);
    render();
    if(game.winner){ showEndOverlay(game.winner); return; }
    if(game.capture && game.capture.by==="B"){ aiStep(); return; }
    setTurnText();
  },160);
}

function onClickPos(i){
  if(MODE!=="AI") return;
  if(game.winner) return;

  const b=game.board;
  const me="W", opp="B";

  if(game.capture){
    if(game.capture.by!==me) return;
    if(b[i]!==opp) return;
    if(!game.capture.removable.includes(i)) return;
    doActionAI({type:"capture",at:i});
    return;
  }

  const phase=phaseOf(game,me);

  if(phase==="placing"){
    if(b[i]!==null) return;
    doActionAI({type:"place",to:i});
    return;
  }

  if(b[i]===me){
    game.pendingMover=(game.pendingMover===i?null:i);
    render();
    return;
  }

  if(b[i]===null && game.pendingMover!==null){
    const from=game.pendingMover;
    const fly=canFly(game,me);
    if(!fly && !ADJ[from].includes(i)) return;

    if(lastHumanMove && lastHumanMove.from===i && lastHumanMove.to===from){
      setStatus("Aynƒ± hamleyi hemen geri alamazsƒ±n. Farklƒ± hamle dene.");
      return;
    }

    game.pendingMover=null;
    doActionAI({type:"move",from,to:i});
  }
}

/* ================= NEW GAME ================= */
function newGameAI(){
  game=freshState();
  history=[JSON.parse(JSON.stringify(game))];
  lastHumanMove=null;
  render();
  setStatus("Sƒ±ra sende. Bo≈ü bir noktaya ta≈ü koy.");
}

/* ================= Buttons ================= */
$("#toggleOnline").addEventListener("click", ()=>{
  const p=$("#onlinePanel");
  p.style.display=(p.style.display==="none"?"block":"none");
});

$("#startAI").addEventListener("click", ()=>{
  if(!profileOK()) return;
  MODE="AI"; ROLE="W"; ROOM=null;
  openGameUI();
  newGameAI();
});

$("#newBtn").addEventListener("click", ()=>{
  if(MODE==="AI") newGameAI();
  else setStatus("Online mod bu s√ºr√ºmde kapalƒ±. (AI √ßalƒ±≈üƒ±yor.)");
});

$("#undoBtn").addEventListener("click", ()=>{
  if(MODE!=="AI") return;
  if(history.length<=1) return;
  history.pop();
  game=JSON.parse(JSON.stringify(history[history.length-1]));
  render();
  setTurnText();
});

$("#hintBtn").addEventListener("click", ()=>{
  if(MODE!=="AI") return;
  if(game.winner) return;
  if(game.capture && game.capture.by==="W"){ setStatus("ƒ∞pucu: Alƒ±nabilir ta≈ülardan birini se√ß."); return; }
  if(game.turn!=="W") return;
  const depth=(game.placed.W<9||game.placed.B<9)?3:4;
  const {action}=minimax(game,depth,-Infinity,Infinity,false);
  if(!action){ setStatus("ƒ∞pucu bulunamadƒ±."); return; }
  if(action.type==="place") setStatus(`ƒ∞pucu: #${action.to+1} noktasƒ±na ta≈ü koy.`);
  else if(action.type==="move") setStatus(`ƒ∞pucu: #${action.from+1} ‚Üí #${action.to+1}.`);
  else setStatus("ƒ∞pucu: Ta≈ü al.");
});

$("#leaveBtn").addEventListener("click", ()=>{
  MODE=null; ROLE="W"; ROOM=null;
  game=freshState(); history=[];
  setLoginMsg(""); setLoginMsgMain("");
  openLoginUI();
});

/* ================= ONLINE (Firebase) ‚Äî sadece istenirse =================
   ≈ûimdilik AI giri≈üini garantiye almak i√ßin online kƒ±smƒ± devre dƒ±≈üƒ±.
   Online istenirse, bir sonraki adƒ±mda bu alana dinamik Firebase eklenir.
========================================================================= */
$("#createRoom").addEventListener("click", ()=>{
  setLoginMsg("Online mod bir sonraki adƒ±mda a√ßƒ±lacak. ≈ûu an AI √ßalƒ±≈üƒ±yor.");
});
$("#joinRoomBtn").addEventListener("click", ()=>{
  setLoginMsg("Online mod bir sonraki adƒ±mda a√ßƒ±lacak. ≈ûu an AI √ßalƒ±≈üƒ±yor.");
});

/* ================= Initial ================= */
render();
setLoginMsgMain("AI ile ba≈ülamak i√ßin bilgileri girip butona bas.");
</script>
</body>
</html>
