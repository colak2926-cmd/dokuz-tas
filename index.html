<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dokuz Ta≈ü ‚Äì AI + Online</title>

<style>
body{margin:0;font-family:Arial;background:#0b1020;color:#fff}
.card{background:#121a33;border-radius:14px;padding:14px;margin-bottom:12px}
button{padding:10px 14px;border-radius:10px;border:none;font-weight:bold;cursor:pointer}
input{padding:10px;border-radius:8px;border:none;width:100%}
.row{display:flex;gap:10px;flex-wrap:wrap}
.hidden{display:none}
svg{width:100%;max-width:600px}
.pos{fill:#0b1020;stroke:#9aa5ff;stroke-width:5;cursor:pointer}
.stoneW{fill:#f59e0b}
.stoneB{fill:#0b3a8a}
.sel{stroke:#ffd166;stroke-width:6}
#overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;
background:rgba(0,0,0,.7);z-index:99}
#modal{background:#1e2a60;padding:20px;border-radius:16px;text-align:center}
#confetti{position:fixed;inset:0;pointer-events:none;display:none}
</style>
</head>

<body>

<canvas id="confetti"></canvas>

<div id="overlay">
  <div id="modal">
    <h2 id="endTitle"></h2>
    <p id="endText"></p>
    <button onclick="location.reload()">Tekrar Oyna</button>
  </div>
</div>

<div class="card">
  <h2>Dokuz Ta≈ü ‚Äì Giri≈ü</h2>
  <input id="name" placeholder="Ad Soyad"><br><br>
  <input id="classroom" placeholder="Sƒ±nƒ±f / ≈ûube"><br><br>

  <div class="row">
    <button id="aiBtn">ü§ñ Bilgisayara Kar≈üƒ±</button>
    <button id="onlineBtn">üåê Online Rakip</button>
  </div>

  <!-- ONLINE Gƒ∞Rƒ∞≈û HER ZAMAN G√ñR√úN√úR -->
  <div id="onlineBox" class="card">
    <input id="roomCode" placeholder="Oda Kodu (yoksa bo≈ü bƒ±rak)">
    <div class="row" style="margin-top:10px">
      <button id="createRoom">Oda Olu≈ütur</button>
      <button id="joinRoom">Odaya Gir</button>
    </div>
  </div>

  <div id="loginMsg"></div>
</div>

<div class="card hidden" id="gameUI">
  <h3 id="status">Oyun ba≈ülƒ±yor‚Ä¶</h3>

  <svg viewBox="0 0 1000 1000">
    <rect x="100" y="100" width="800" height="800" fill="none" stroke="#9aa5ff" stroke-width="8"/>
    <rect x="250" y="250" width="500" height="500" fill="none" stroke="#9aa5ff" stroke-width="8"/>
    <rect x="400" y="400" width="200" height="200" fill="none" stroke="#9aa5ff" stroke-width="8"/>

    <line x1="500" y1="100" x2="500" y2="400" stroke="#9aa5ff" stroke-width="8"/>
    <line x1="500" y1="600" x2="500" y2="900" stroke="#9aa5ff" stroke-width="8"/>
    <line x1="100" y1="500" x2="400" y2="500" stroke="#9aa5ff" stroke-width="8"/>
    <line x1="600" y1="500" x2="900" y2="500" stroke="#9aa5ff" stroke-width="8"/>

    <g id="board"></g>
  </svg>
</div>

<script>
/* ======= OYUN MANTIƒûI (RESMƒ∞) ======= */

const POS=[
[100,100],[500,100],[900,100],
[250,250],[500,250],[750,250],
[400,400],[500,400],[600,400],
[100,500],[250,500],[400,500],[600,500],[750,500],[900,500],
[400,600],[500,600],[600,600],
[250,750],[500,750],[750,750],
[100,900],[500,900],[900,900]
];

const ADJ=[
[1,9],[0,2,4],[1,14],[4,10],[1,3,5,7],[4,13],[7,11],[4,6,8],[7,12],
[0,10,21],[3,9,11,18],[6,10,15],[8,13,17],[5,12,14,20],[2,13,23],
[11,16],[15,17,19],[12,16],[10,19],[16,18,20,22],[13,19],[9,22],[19,21,23],[14,22]
];

const MILLS=[
[0,1,2],[3,4,5],[6,7,8],[9,10,11],[12,13,14],[15,16,17],[18,19,20],[21,22,23],
[0,9,21],[3,10,18],[6,11,15],[1,4,7],[16,19,22],[8,12,17],[5,13,20],[2,14,23]
];

let board=Array(24).fill(null);
let placed={W:0,B:0};
let turn='W';
let selected=null;
let lastMove={W:null,B:null};

function canFly(p){
  return placed[p]>=9 && board.filter(x=>x===p).length<=3;
}

function sameOrReverse(p,from,to){
  const lm=lastMove[p];
  if(!lm)return false;
  return (lm.from===from && lm.to===to)||(lm.from===to && lm.to===from);
}

function checkWin(){
  if(placed.W<9||placed.B<9)return null;
  if(board.filter(x=>x==='W').length<3)return 'B';
  if(board.filter(x=>x==='B').length<3)return 'W';
  return null;
}

function render(){
  const g=document.getElementById("board");
  g.innerHTML="";
  for(let i=0;i<24;i++){
    const [x,y]=POS[i];
    const c=document.createElementNS("http://www.w3.org/2000/svg","circle");
    c.setAttribute("cx",x);c.setAttribute("cy",y);c.setAttribute("r",34);
    c.setAttribute("class","pos");
    if(i===selected)c.classList.add("sel");
    c.onclick=()=>clickPos(i);
    g.appendChild(c);
    if(board[i]){
      const s=document.createElementNS("http://www.w3.org/2000/svg","circle");
      s.setAttribute("cx",x);s.setAttribute("cy",y);s.setAttribute("r",18);
      s.setAttribute("class",board[i]==='W'?"stoneW":"stoneB");
      g.appendChild(s);
    }
  }
}

function clickPos(i){
  if(turn!=='W')return;
  if(placed.W<9){
    if(board[i])return;
    board[i]='W';placed.W++;turn='B';
    render();checkEnd();return;
  }
  if(board[i]==='W'){selected=i;render();return;}
  if(selected!==null&&board[i]==null){
    if(!canFly('W')&&!ADJ[selected].includes(i))return;
    if(sameOrReverse('W',selected,i))return;
    board[selected]=null;board[i]='W';
    lastMove.W={from:selected,to:i};
    selected=null;turn='B';
    render();checkEnd();
  }
}

function aiMove(){
  if(turn!=='B')return;
  let moves=[];
  for(let i=0;i<24;i++){
    if(board[i]==='B'){
      const targets=canFly('B')
        ? board.map((v,j)=>v===null?j:null).filter(x=>x!==null)
        : ADJ[i].filter(j=>board[j]==null);
      targets.forEach(t=>{
        if(!sameOrReverse('B',i,t))moves.push([i,t]);
      });
    }
  }
  if(moves.length===0)return;
  const [f,t]=moves[Math.floor(Math.random()*moves.length)];
  board[f]=null;board[t]='B';
  lastMove.B={from:f,to:t};
  turn='W';render();checkEnd();
}

function checkEnd(){
  const w=checkWin();
  if(w){
    document.getElementById("overlay").style.display="flex";
    document.getElementById("endTitle").innerText=w==='W'?"KAZANDIN üéâ":"KAYBETTƒ∞N üòï";
    document.getElementById("endText").innerText="Tekrar oynamak ister misin?";
    startConfetti();
    return;
  }
  if(turn==='B')setTimeout(aiMove,400);
}

document.getElementById("aiBtn").onclick=()=>{
  document.getElementById("gameUI").classList.remove("hidden");
  document.getElementById("status").innerText="Sƒ±ra sende (Turuncu)";
  render();
};

/* === KONFETƒ∞ === */
const canvas=document.getElementById("confetti");
const ctx=canvas.getContext("2d");
let confetti=[];
function startConfetti(){
  canvas.style.display="block";
  canvas.width=innerWidth;canvas.height=innerHeight;
  confetti=Array.from({length:150},()=>({
    x:Math.random()*innerWidth,
    y:Math.random()*innerHeight,
    v:2+Math.random()*4,
    c:`hsl(${Math.random()*360},90%,60%)`
  }));
  requestAnimationFrame(drawConfetti);
}
function drawConfetti(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  confetti.forEach(p=>{
    ctx.fillStyle=p.c;
    ctx.fillRect(p.x,p.y,6,10);
    p.y+=p.v;if(p.y>innerHeight)p.y=0;
  });
  requestAnimationFrame(drawConfetti);
}
</script>
</body>
</html>
